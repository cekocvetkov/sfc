---
title: "Keycloak with Quarkus and Next.js/Auth.js: Full-Stack Authentication"
date: "2025-04-06"
tags: ["keycloak", "quarkus", "nextjs", "auth"]
published: true
image: "keycloak-quarkus-next/main.webp"
---

# Keycloak with Quarkus and Next.js/Auth.js: Full-Stack Authentication

<Image
  placeholder="blur"
  blurDataURL="data:image/webp;base64,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"
  alt="Main image of article"
  src={"/images/keycloak-quarkus-next/main.webp"}
  width={0}
  height={0}
  sizes="100vw"
  style={{ width: "1400px", height: "335px", objectFit: "cover" }}
/>
<small className="w-full h-2 flex justify-center" style={{ marginTop: "-2rem" }}>
  you can also read this article in Medium -> click [here](https://medium.com/javarevisited/keycloak-with-quarkus-and-next-js-auth-js-full-stack-authentication-ae464f484abe)
</small>
<br />

Every developer has to face this at some point — implementing authentication for a full-stack project — frontend **and** backend.

We’ll look closely at the process by building an application and securing it with Keycloak
— an open-source identity and access management solution, that handles user login, registration,
and token-based security (like [OAuth 2.0](https://oauth.net/2/) or [OpenID Connect](https://openid.net/developers/how-connect-works/). We’ll focus on something practical here —
Keycloak is used by companies worldwide and provides a set of really killer features. Chances are, you’re going to face Keycloak as an authentication
solution at some point in your career, so let’s build something small and play around with it, to understand how it works and what it can do for us.

We’ll use **Next.js** for our frontend and **Quarkus** for the backend.
Next.js is particularly interesting when it comes to authentication, because it can mix server-side rendering (SSR) and client-side interactions,
which can create some challenges when getting the user session data. Quarkus has become my go-to backend technology for building fast, scalable,
and modern APIs. Together, they create a seamless flow: Keycloak authenticates users and issues tokens, Quarkus validates those tokens and secures the API,
and Next.js consumes the API while delivering a smooth sign-in user experience — ensuring your application is secure. Here is a diagram of how all three components play together:

<Image
  alt="Diagramm overview"
  src={"/images/keycloak-quarkus-next/diagram-overview.webp"}
  placeholder="blur"
  blurDataURL="data:image/webp;base64,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"
  width={1400}
  height={1000}
  objectFit="cover"
  style={{ scale: "100%" }}
/>

Keep in mind that this is somewhat simplified and doesn’t discuss some of the steps (like token exchange or the signing of JWT tokens in the backend) in detail.

**Now let’s start with the backend and zoom in on the diagram a bit.**

## Backend

We’ll create a simple Quarkus backend application and use its [Dev Services](https://quarkus.io/guides/dev-services) to spin up a Keycloak container on start.
The backend will serve a single endpoint `/protected` to demonstrate the Keycloak integration.

Here is our diagram, but zoomed in on the backend part:

<Image
  alt="Diagramm backend"
  src={"/images/keycloak-quarkus-next/diagramm-backend.webp"}
  placeholder="blur"
  blurDataURL="data:image/webp;base64,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"
  width={1400}
  height={1000}
  objectFit="cover"
  style={{ scale: "100%" }}
/>

JWT tokens, obtained by our frontend through the user login, are signed with a **private key** by Keycloak.
The tokens are then sent on every request to the backend and Quarkus verifies the token’s signature using Keycloak’s **public key**, which it obtains beforehand
(e.g., request to [JWKS](https://documentation.cloud-iam.com/how-to-guides/configure-remote-jkws.html) endpoint, usually `/auth/realms/MY-REALM/protocol/openid-connect/certs`). The key is usually cached (See steps 2.1, 2.2., 2.3 from the diagram)
to avoid repeated requests.

We’re going to use the [quarkus-oidc extension](https://quarkus.io/guides/security-oidc-code-flow-authentication-tutorial) where the **verification of the JWT token happens under the hood** automatically.
That’s actually pretty neat — we just need the right configuration in our `applciation.properties` and get this out of the box.
Let’s go into some details and set up our backend.

### 1. Create a Quarkus Java Application

Let’s start by creating a Quarkus Java Application for our example. Go to [https://code.quarkus.io/](https://code.quarkus.io/):

1. Name your project
2. Choose `Gradle` as Build Tool (optional, if you want to follow along. `Maven` would of course also work)
3. Preferably — Java 21
4. Add the `quarkus-rest-jackson` and the `quarkus-oidc` dependencies.

<Image
  alt="Quarkus code dev"
  src={"/images/keycloak-quarkus-next/quarkus-code.webp"}
  placeholder="blur"
  blurDataURL="data:image/webp;base64,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"
  width={1400}
  height={1000}
  objectFit="cover"
  style={{ scale: "100%" }}
/>

Download the project and open it in your favourite IDE — I used IntelliJ.
In `src/main/java` you should be able to see some automatically generated code we get from the starter, probably `GreetingResource` — delete it and add a new class with the following content:

```java
package com.tsvetkov;

import jakarta.ws.rs.GET;
import jakarta.ws.rs.Path;
import jakarta.ws.rs.Produces;
import jakarta.ws.rs.core.MediaType;

@Path("/protected")
public class ProtectedResource {

    @GET
    @Produces(MediaType.TEXT_PLAIN)
    public String protectedInfo() {
        return "This is highly sensitive private protected secret information";
    }
}
```

your folder structure should look something like this:

<Image
  alt="Backend Code structure"
  src={"/images/keycloak-quarkus-next/code-structure.webp"}
  placeholder="blur"
  blurDataURL="data:image/webp;base64,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"
  width={1400}
  height={1000}
  objectFit="cover"
  style={{ scale: "100%" }}
/>

Then put the following in your `src/resources/application.properties`:

```
quarkus.keycloak.devservices.port=8082
quarkus.oidc.client-id=backend
quarkus.oidc.application-type=service
quarkus.http.auth.permission.authenticated.paths=/*
quarkus.http.auth.permission.authenticated.policy=authenticated
```

**Let’s explain what these properties do:**

`quarkus.keycloak.devservices.port` — Because we added the `quarkus-oidc` extension, the [Keycloak Dev Service](https://quarkus.io/guides/dev-services#keycloak) will be enabled and
a Keycloak docker container will be started automatically on start of the application. Through this property, we set the port on which the Keycloak container will be started, in our case — 8082

`quarkus.oidc.client-id=backend` — this is the client-id for our application — will get automatically created when the container starts.

`quarkus.oidc.application-type=service` — specifies how the application interacts with OpenID Connect (OIDC).
We use type `service` (for backend services using client credentials), but there are other options here like `webapp` for browser-based login,
or `hybrid` (supporting both webapp and service authentication).

The last two properties configure **all** of our endpoints to be protected and need authentication.

### 2. Run Quarkus Backend App

Now, we can start our Quarkus application and check if everything works as expected. Just go to the terminal in the project folder and execute:

```
./gradlew quarkusDev
```

As already mentioned, this will automatically start a Keycloak container for us. We can go to http://localhost:8082 (username: admin, password: admin) and access the Keycloak UI!

<Image
  alt="Keycloak UI"
  src={"/images/keycloak-quarkus-next/keycloak-ui-users.webp"}
  placeholder="blur"
  blurDataURL="data:image/webp;base64,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"
  width={1400}
  height={1000}
  objectFit="cover"
  style={{ scale: "100%" }}
/>

The **Keycloak Dev Services** set up some things for us already!

A new realm `quarkus` got created, along with two roles — `admin` and `user` and two users:
**Alice** who has `admin` and `user` roles assigned, and **Bob** who only has the `user` role. The `client-id` “**backend**” we set in our `application.properties` also got
automatically created. That’s already a pretty nice Keycloak server setup for us to play around with.

Now let’s try to hit the `/protected` endpoint of our app (which is running on http://localhost:8080). You can use Postman or any other API Platform to test this:

<Image
  alt="Postman 1"
  src={"/images/keycloak-quarkus-next/postman-1.webp"}
  placeholder="blur"
  blurDataURL="data:image/webp;base64,UklGRmoJAABXRUJQVlA4WAoAAAAgAAAANgMACQIASUNDUMgBAAAAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADZWUDggfAcAAHCKAJ0BKjcDCgI+7W6wVimlJCOgURjZMB2JaW7hY/7MbvOk+VrDdk0f6n/GRsE//62ZjWPcz5AAw3lnT4AfSeZBVLpzFo3mAH0nmQWf0yqd0+Fsc+ulNOsL0ZwhPesqbHhWNOwfIOIstS3Tmws3cJOYsIL3kLG9kF0m97Av6ysSWZsRErT2humWjNHxuf55Vygb2CMXShiGN7LukysgZZjhEeMDh8qjPi4Ik0cswpp0S02oI7i0mRh9nSZl8c2SRRxv5p5PoOnFoG6dbU5O2zUhb06xunhWNyMXSPgYxqdNADe2oeZvHWTwd9eveXT/1H7ILpN71OTenMU3S6lPPeRKJ5sjsrFrsmMTneECiQEG2SZWob3C2QXSb3m1xRZPPeBjtaaZFxB6nJvTtXdjj3paIGiMjFGb8Ze8hY3sgrFxpBr57wLz3kjI+zRkcPepyb1IEAtF1+FEFyr7HgXoqEp3qS95A8afcVLTTIuJ12e4zFNNMi1/THNNIWN7LsOPykkTwY3xtTk+m54RaakPmmRvz5piuvdn/HrOusFh57UJmu1+pybpXoQXIsS7jGmRcaQp43sfbERRZTrjRx17sy1G2ZwPsJI1QZpAWjOWx9fhQ+B09kqIhEMyW1Y4osnnvAvPeYk0gKHXuygWT3GfyCDYyLijHV3Gj6+dpyG+tNKDdNKaafcINfPeBee8C73Xuy4dFoB2MqaUoYkaoM0f1VLvFYJ/YSmiwYXW1ALRhrSxBFk73XuvehfL3RbmLeoV3rjWM4rTQPHzsuJ0Le9nJGI1C8nnvAvPeBehM9m6JC23ijWLTmNGcogu0rO89nJPGcgv8Cw4ERGlzhbAvQmew7ar7s5yzpeLTmLTpy9q0j2Bwh2U6r64x6Axm9kyLjpebCQ+mx8AfSeZBVL61UfneOknfB/ssurpN8LN2Ryh18seM/Hh4B9J5kFUunMW5zAhhqonghD7mALg+2ls9vrFHYuGEz8APpPMgql03SrrnJrcJdo67+W/FolPT1BQql05i05i05pRKUyzH0lIh822qPph8zpR4mfcg05i05i05i05nnYft/xWCmqwGUZ6pG5WD+d0nmNwwmfgB9J5kFUm+d/4x/+LCDwmy3qQJO3CClOwfIEtOYtOYtOYtN3YttJVXrcCsdl/3+HpS1pN0VEKpOOk8yCqXTmLTmdbWJUepv/3tp7luSZVl3SbUAe3JsH0nmQVS6cxac0ljMvoqSmEJGtMcaZs+ML6dYdIeqXTmLTmLTdl2Qo9rj3SbqtZly8FhRTWosdxnomTPwA+k8yCplvIb6ENSIHyTYZY/+oSxKAFh/EVMWnMWnMWnWF46k3znqz59F0nmyb51UC4CAA7sFpzYPpPMgoO4KaI5qqrpOXrM6bUxadCxfO58QAwPpPMgqsO1TkC62XVfkVQ7K4xHLtDo7G9OpIxacxacxdoJonS0nmXyPGMvdyU++Punxt+IKtlNOYtOZbSINLowAD+6cL3ysOF75JZaYiHVDsf+ZYK0r0gMwG26WmPniuCO0tauSnoYkIjlz9BG0MVtd93BOOi0IgwLWOedZVexOEUUGuemJX9+FbAayeTBIzU0FEMvLUjokbz5YCPuhOEqo1sI/cGGPC6ndAWl45FjvFJtOSOY4AGZVdZuQY2wiXAd61+JKVrUid6je0pTInJHWmEmISd7AcidwlflgUmaI8XK+iiRortPBAAg1mRM5OL4CtNdRRwYRkEJDIaLObQ70yzVL/Htb6IN1IDbk6gdd6bQHE/3Dc3j2S4VNgy6c1C3bX0zViKGApuonmYFvg3kIoOffexTz+3iAaUEiGzgEzM9L8xzTgu3DezxdvgEod771/JIerMKzZzOg/WAh5q7m1tvVDd1JzaqB8ynoNHAqWqv1kQKJ8aAXQDhMEGodc2YTEZMoRljkz2fuTYWOLdA5ij+1SL3oP0o+YSt0G0gGr16G2WIHfSDtroEW9HENVvRZeUhM+gM1vz/uFO9kha+eCFsFyZYWAZi4j6Wv2VufYStlWJTIhqxilVmIGqerRNQRRhvapYjAwNBgFEjcbSNBAAI0dwLy8BuHieL0jqc138GSzOQoodnrE9u1/deAAaUPAGnpzgqbBgU2/vLFNoCVSv8c97YIAeAhj5M49UxJNCTae/F6JNXbbKwAAMmA96kg0OtuuqjT9P6bhCgAAHScvcNnkwLqWJ8zHVDPoshAAHe6m1XGAb5BTtN3A7m8YtoQAChv4jrJFOMepFwAAR5y+ac/AS3yJ/2Ia2UNvNp6oAADDK9+lefKsSf9nFBAgAGGOjJzVJdSOcixVQrkJsMgAAI9YXKSokL21G5I9dXnMqVZfAAbydpoTNHkkJkiZ8jB0LTBPkAEdHmTTLON2e4Nfqa4jiT7LVkQSEwSfLFP01mIAR00nJZYpKgC9j6QO352o14NwzESHqbsn7eYCR/UZ5vrunIXv1hNVF0/UAchcqY6eAz8wv1mQRgY2/zxvbsaWDwtlsemKK44FPAM2ScqoBZ87BADjnrFj+ehQhwWSjdguqABVeCctHlHHWWOIA"
  width={1400}
  height={1000}
  objectFit="cover"
  style={{ scale: "100%" }}
/>

Exactly as expected — we get a **401 Unauthorized**. What we need now is to authenticate ourselves. We need to hit this endpoint with a valid JWT Token in order
for our backend to verify we’re an allowed user. We can obtain a JWT token from the [Keycloak token endpoint](https://www.rfc-editor.org/rfc/rfc8693#name-request), which looks like this:

```
http://<KEYCLOAK_SERVER>/realms/<REALM_NAME>/protocol/openid-connect/token
```

Let’s use Postman again to get a valid JWT token. We’ll use `grant_type` **password** for this. This is not recommended
for production apps, but here we just want to test our endpoint. Normally the JWT token will be available in our frontend after login, and
that’s where we’ll send the requests to the backend in our Full-Stack Application. We’ll get to this in a minute, but first, let’s get a valid JWT token to test our `/protected `endpoint

<Image
  alt="Postman 2"
  src={"/images/keycloak-quarkus-next/postman-2.webp"}
  placeholder="blur"
  blurDataURL="data:image/webp;base64,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"
  width={1400}
  height={1000}
  objectFit="cover"
  style={{ scale: "100%" }}
/>

Here we send a request to the Keycloak token endpoint with our
**backend** client-id and user credentials (user: alice, password: alice). Now we can use the `access_token` to send a request to our `/protected` endpoint:

<Image
  alt="Postman 3"
  src={"/images/keycloak-quarkus-next/postman-3.webp"}
  placeholder="blur"
  blurDataURL="data:image/webp;base64,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"
  width={1400}
  height={1000}
  objectFit="cover"
  style={{ scale: "100%" }}
/>

That’s how easy it is to set up Keycloak with Quarkus for development purposes. We already have our Backend App and a Keycloak Instance running!

Our backend can validate tokens issued from our Keycloak instance — great! Now let’s zoom in on the frontend part. We now need to allow our users to open the browser, navigate to our website, authenticate with valid credentials, see some content, and get the protected data from our backend.

## Frontend

We’ll create a simple Next.js application and use the free open-source [Auth.js](https://authjs.dev/) authentication library.

Why use Auth.js? Well, it simplifies a lot of stuff for us. Here are a couple of very useful features we’ll be using:

1. **Auth.js provides a built-in Keycloak provider**. That means, we don’t have to manually implement OAuth 2.0 or OpenID Connect (OIDC) flows.
   It also automatically exposes a [REST API](https://next-auth.js.org/getting-started/rest-api) with endpoints like `/api/auth/signin` that trigger
   the sign-in flow of the respective providers, or `/api/auth/callback/:provider` (in our case `:provider` is Keycloak) that can handle the returning requests from OAuth services during sign-in.

2. **Auth.js provides the useSession hook and convenient functions to access the session state on both the client and server sides**. This is especially useful in Next.js, where developers often mix server-side rendering (SSR), static site generation (SSG), and client-side interactions.

3. **Token refresh**: Keycloak issues short-lived access tokens and longer-lived refresh tokens. Auth.js can automatically handle token refreshing for us, which is awesome.

4. **Middleware for Route Protection**: Auth.js integrates with Next.js middleware to protect certain routes. We can easily restrict access to specific pages.

It’s also worth mentioning, that the library also poses some challenges and could create some difficulties, but we’ll talk about these later.

Let’s explore how Keycloak, Next.js, and Auth.js work together in more detail:

<Image
  alt="Diagramm frontend"
  src={"/images/keycloak-quarkus-next/diagramm-frontend.webp"}
  placeholder="blur"
  blurDataURL="data:image/webp;base64,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"
  width={1400}
  height={1000}
  objectFit="cover"
  style={{ scale: "100%" }}
/>

Let’s discuss this briefly, as this diagram shows some details that weren’t mentioned in the previous drawings (e.g. Authorization Code Flow).

- **User requests protected page (e.g. `/protected-page`)**
- **Auth.js automatically checks for valid session**
- **Initiate the authentication flow**

Auth.js redirects the user to its own authentication endpoint — `/api/auth/signin` which initiates the Keycloak authentication process.
It contains the logic to construct an OpenID Connect authorization URL which contains information like `Redirect URI`, `Client ID`, `Response type` (typically `code` for authorization code flow) and `Required scopes`

- **Keycloak Authentication**
  The user is then redirected to the Keycloak’s auth endpoint with the above-mentioned parameters and the URL looks like this:
  `https://<KEYCLOAK_SERVER>/realms/<REALM_NAME>/protocol/openid-connect/auth`

- **User enters credentials and Keycloak validates them against its user database**.
  If valid — Keycloak generates an authorization code and redirects back to the Next.js application — `/api/auth/callback/keycloak` , where the authorization code is included as a query parameter.

(I won’t get into details in this tutorial on how the authorization code flow works, but you can read more about it [here](https://auth0.com/docs/get-started/authentication-and-authorization-flow/authorization-code-flow).)

- **Exchange the Authorization code for Tokens**
  Auth.js receives the authorization code and makes a server-side request to Keycloak’s token endpoint. The request includes the authorization code among other things like the Redirect URI.

Keycloak validates the request and returns the Access token (JWT), the refresh token, and the ID token.

- **Session Tokens**
  Auth.js validates the tokens and extracts the user information from the ID token. It then creates the session and sets the HttpOnly cookie in the browser. After that, the user is redirected to the requested protected page.

### 1. Create a simple Next.js App with Auth.js

Alright, now let’s create a Next.js Application and play around with our setup.

Go to your terminal and execute:

```
npx create-next-app@latest
```

Choose a name for your project and then select “**yes**” on all the prompted questions.

Then open the project in your favourite editor and create the following files:

`app/nav.tsx` and `app/protected-page/page.tsx`

your folder structure should look like this:

<Image
  alt="Frontend code structure"
  src={"/images/keycloak-quarkus-next/code-frontend-structure.webp"}
  placeholder="blur"
  blurDataURL="data:image/webp;base64,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"
  width={1400}
  height={1000}
  objectFit="cover"
  style={{ scale: "100%" }}
/>

Let’s do things step by step and just write some minimal initial code for our application.

### 2. Initial code

Let’s start from our layout.tsx which should look like this in order for you to follow along:

```typescript
import type { Metadata } from "next";
import { Geist, Geist_Mono } from "next/font/google";
import "./globals.css";
import Nav from "./nav";

const geistSans = Geist({
  variable: "--font-geist-sans",
  subsets: ["latin"],
});

const geistMono = Geist_Mono({
  variable: "--font-geist-mono",
  subsets: ["latin"],
});

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <body className={`${geistSans.variable} ${geistMono.variable} antialiased`}>
        <Nav></Nav>
        <main className="container mx-auto p-4">{children}</main>
      </body>
    </html>
  );
}
```

You notice that this file contains the **Nav** element from `/app/nav.tsx` so let’s code that next:

```typescript
"use client";
import Link from "next/link";
import { usePathname } from "next/navigation";
import React from "react";

function Nav() {
  const pathname = usePathname(); // Gets the current route

  return (
    <nav className="bg-gray-800 p-4">
      <div className="flex justify-center gap-x-60 items-center">
        <div className="flex gap-x-5">
          <Link href="/" className={`${pathname === "/" ? "text-yellow-500" : "text-white"} hover:text-gray-300`}>
            Home
          </Link>
          <Link href="/protected-page" className={`${pathname === "/protected-page" ? "text-yellow-500" : "text-white"} hover:text-gray-300`}>
            Protected
          </Link>
        </div>
        <button onClick={() => {}} className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">
          Login
        </button>
      </div>
    </nav>
  );
}

export default Nav;
```

The `app/page.tsx` component will be our public home page. We’ll keep things minimal too:

```typescript
export default function Home() {
  const username = "You're not logged in.";
  return (
    <div className="text-center">
      <h1 className="text-3xl font-bold mb-4">Welcome Home</h1>
      <h2 className="text-3xl text-orange-400 mb-4"> {username}</h2>
      <p className="text-gray-600">This is a public page anyone can see</p>
    </div>
  );
}
```

and lastly, our `/protected-page/page.tsx` which will set up a page that we want
to secure with Keycloak at http://localhost:3000/protected-page (Our navigation has a link to it too [see two code blocks above]):

```typescript
import React from "react";

function ProtectedPage() {
  return (
    <div className="text-center">
      <h1 className="text-3xl font-bold mb-4">Protected Page</h1>
      <p className="text-gray-800">
        Welcome <span className="text-green-800">(Some User)!</span>
        <br />
        <br />
        This is a protected page.
      </p>
    </div>
  );
}

export default ProtectedPage;
```

Now go to your terminal, execute npm run dev and you should see this:

<div className="flex justify-between">
    <div>
        <Image
        alt="Layout 1"
        src={"/images/keycloak-quarkus-next/layout-11.webp"}
        placeholder="blur"
        blurDataURL="data:image/webp;base64,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"
        width={250}
        height={400}
        objectFit="cover"
        />
    </div>
    <div>

        <Image
        alt="Layout 2"
        src={"/images/keycloak-quarkus-next/layout-12.webp"}
        placeholder="blur"
        blurDataURL="data:image/webp;base64,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"
        width={250}
        height={400}
        objectFit="cover"
        />
    </div>

</div>

### 3. Add Auth.js

Now it gets interesting — we will [install Auth.js](https://authjs.dev/getting-started/installation?framework=Next.js) and set up its Keycloak provider. Go to your terminal and execute:

```
npm install next-auth@beta
```

[Auth.js CLI](https://github.com/nextauthjs/cli) also provides a neat way to generate secrets. We’ll need to create one for our setup, so let’s do this now. Execute the following, which will create an .env.local file for us and generate a secret there:

```
npx auth secret
```

Your `.env.local` file should then look like this:

<Image
  alt="Env file"
  src={"/images/keycloak-quarkus-next/env-local.webp"}
  placeholder="blur"
  blurDataURL="data:image/webp;base64,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"
  width={1400}
  height={1000}
  objectFit="cover"
  style={{ scale: "100%" }}
/>

We’ll use a public Keycloak client for our frontend, so we won’t need a secret actually, but the Auth.js Provider needs one (even if its `null`, [see here](https://github.com/nextauthjs/next-auth/issues/5598))

Next, we’ll create an `auth.js` file in the root of our project and set up the actual configuration of the Keycloak provider:

```typescript
import NextAuth, { NextAuthResult } from "next-auth";
import KeycloakProvider from "next-auth/providers/keycloak";

const authData: NextAuthResult = NextAuth({
  providers: [
    KeycloakProvider({
      clientId: process.env.KEYCLOAK_CLIENT_ID,
      issuer: process.env.KEYCLOAK_ISSUER,
    }),
  ],
});

export const { handlers, signIn, signOut, auth } = authData;
```

Also, add a Route Handler under `/app/api/auth/[...nextauth]/route.ts` :

```typescript
import { handlers } from "@/auth";
export const { GET, POST } = handlers;
```

These are used to expose the REST API endpoints (such `/api/auth/signin` for redirecting users to the Keycloak login page).

You probably noticed some environmental variables here, which we do need to add to our `.env.local` file.

```typescript
KEYCLOAK_CLIENT_ID=frontend
KEYCLOAK_ISSUER=http://localhost:8082/realms/quarkus
```

The `KEYCLOAK_ISSUER` is our Keycloak endpoint and the `KEYCLOAK_CLIENT_ID` points to our Keycloak client — “frontend”. You probably
guessed this — we need to create this ourselves in the Keycloak UI. Let’s go to http://localhost:8082/ again and do this:

<div className="grid grid-cols-2 ">
    <div>
        <Image
        alt="Keycloak Client 1"
        src={"/images/keycloak-quarkus-next/keycloak-client11.webp"}
        placeholder="blur"
        blurDataURL="data:image/webp;base64,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"
  width={1400}
  height={1000}
        objectFit="cover"
        />
    </div>
    <div>

        <Image
        alt="Keycloak Client 2"
        src={"/images/keycloak-quarkus-next/keycloak-client-12.webp"}
        placeholder="blur"
        blurDataURL="data:image/webp;base64,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"
     width={1400}

height={1000}
objectFit="cover"
/>

</div>

    <div>

        <Image
        alt="Keycloak Client 3"
        src={"/images/keycloak-quarkus-next/keycloak-client-13.webp"}
        placeholder="blur"
        blurDataURL="data:image/webp;base64,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"

width={1400}
height={1000}
objectFit="cover"
/>

</div>
<div>

        <Image
        alt="Keycloak Client 2"
        src={"/images/keycloak-quarkus-next/keycloak-client-14.webp"}
        placeholder="blur"
        blurDataURL="data:image/webp;base64,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"

width={1400}
height={1000}
objectFit="cover"
/>

</div>

</div>

I hope this is clear enough and you have managed to create your** “frontend” **client 👍

### 4. Sign-in

Now it’s time to add the Sign-in functionality to our web app. Go to our `nav.tsx` and let’s use Auth.js’ `signIn` function to log in when we click the Login button:

```typescript
<button onClick={() => signIn("keycloak")} className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">
  Login
</button>
```

Now go to our application, click on the Login button in our naviagtion and you will see
the Keycloak Login Screen! Use the user “alice” to log in and you can even see your session in the Keycloak UI under (http://localhost:8082/admin/master/console/#/quarkus/sessions)

<div className="flex justify-between">
    <div>
        <Image
        alt="Login 1"
        src={"/images/keycloak-quarkus-next/login1.webp"}
        placeholder="blur"
        blurDataURL="data:image/webp;base64,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"
        width={250}
        height={400}
        objectFit="cover"
        />
    </div>
    <div>

        <Image
        alt="Login 2"
        src={"/images/keycloak-quarkus-next/login2.webp"}
        placeholder="blur"
        blurDataURL="data:image/webp;base64,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"
        width={250}
        height={400}
        objectFit="cover"
        />
    </div>

</div>

Now let’s use some of that login information in our application!
It would be nice to show our user's username on the home page.
Our `Home` component (`/app/page.tsx`)is a server-rendered component, so let’s see how to get our user information in a server-side component:

```typescript
import { auth } from "@/auth";

export default async function Home() {
  const session = await auth();
  const username = session?.user ? session.user.name : "You're not logged in.";

  return (
    <div className="text-center">
      <h1 className="text-3xl font-bold mb-4">Welcome Home</h1>
      <h2 className="text-3xl text-orange-400 mb-4"> {username}</h2>
      <p className="text-gray-600">This is a public page anyone can see</p>
    </div>
  );
}
```

We use Auth.js’ `auth()` function to get information about our session, and from there, we can get our username.
If we’re not logged in, we just show the “You’re not logged in.” message from before. If you go to our application on http://localhost:3000/ you’ll be able to see our username “alice” in the `Home` component!

<Image
  alt="Alice logged in "
  src={"/images/keycloak-quarkus-next/alice.webp"}
  placeholder="blur"
  blurDataURL="data:image/webp;base64,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"
  width={1400}
  height={1000}
  objectFit="cover"
  style={{ scale: "100%" }}
/>

### 5. Sign-out

Signing out looks similar to what we had for our login — Let’s go to our `nav.tsx` component and change the Login button
to “Logout” if the user is logged in. That means that we need user information in our `Nav` component, which is a client-side component, so let’s see how to get our user information on the client side:

```typescript
"use client";
import { signIn, signOut, useSession } from "next-auth/react";
import Link from "next/link";
import { usePathname } from "next/navigation";
import React from "react";

function Nav() {
  const pathname = usePathname(); // Gets the current route
  const session = useSession();

  return (
    <nav className="bg-gray-800 p-4">
      <div className="flex justify-center gap-x-60 items-center">
        <div className="flex gap-x-5">
          <Link href="/" className={`${pathname === "/" ? "text-yellow-500" : "text-white"} hover:text-gray-300`}>
            Home
          </Link>
          <Link href="/protected-page" className={`${pathname === "/protected-page" ? "text-yellow-500" : "text-white"} hover:text-gray-300`}>
            Protected
          </Link>
        </div>
        {!session.data ? (
          <button onClick={() => signIn("keycloak")} className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">
            Login
          </button>
        ) : (
          <button onClick={() => signOut()} className="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded">
            Logout
          </button>
        )}
      </div>
    </nav>
  );
}

export default Nav;
```

We used Auth.js' `useSession` hook to get the login information of our user and added a condition to show the login button if we’re logged-out and the logout button
if we’re logged in. We also added the `signOut` call on click on the logout button.

We also need to wrap all our components that access the `useSession` hook in the Auth.js’ `<SessionProvider>` . Go to `layout.tsx` and add it there:

```typescript
<html lang="en">
  <body className={`${geistSans.variable} ${geistMono.variable} antialiased`}>
    <SessionProvider>
      <Nav></Nav>
      <main className="container mx-auto p-4">{children}</main>
    </SessionProvider>
  </body>
</html>
```

Now if we log in, we see the logout button in the navigation:

<Image
  alt="Alice Logout button"
  src={"/images/keycloak-quarkus-next/alice-logout.webp"}
  placeholder="blur"
  blurDataURL="data:image/webp;base64,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"
  width={1400}
  height={1000}
  objectFit="cover"
  style={{ scale: "100%" }}
/>

That’s already pretty good! But we can still go to the `/protected-page` even if we’re logged out 🤔

### 6. Authorize access to a page

In order to forbid the access to `/protected-page` for unauthenticated users, we need to add the following `middleware.ts` to the root of our project:

```typescript
import { NextResponse } from "next/server";
import { auth } from "./auth";

export default auth((req) => {
  if (!req.auth && req.nextUrl.pathname === "/protected-page") {
    return NextResponse.redirect(new URL(`/api/login?callbackUrl=${encodeURIComponent(req.nextUrl.pathname)}`, req.nextUrl.origin));
  }
});
export const config = {
  matcher: ["/((?!api|_next/static|_next/image|.*\\.png$).*)"],
};
```

Let’s see what happens here, and why it’s a bit tricky when we use Auth.js with providers when it comes to the middleware.

We use the `auth` configuration object as a wrapper for our Middleware,
following the [Auth.js documentation](https://authjs.dev/getting-started/migrating-to-v5#details). Inside we write our little logic that checks if a user
is unauthenticated and wants to access the `/protected-page` => In this case, we redirect to `/api/login` with a callback URL as
a parameter (in this case — `/protected-page` — this is where we want to land after the login).
The `/api/login` is a route that we need to create in order to call the `signIn` method with “Keycloak” as a provider.
The `NextResponse.redirect` code from above makes a GET Request to our own route which we can configure to trigger the `signIn` function from Auth.js.
I hope that was clear enough, but if you want to dig a bit deeper into why this is the most elegant way to go for now, you can read the [discussion here](https://github.com/nextauthjs/next-auth/discussions/11220).

So now create a `route.ts` file under `/api/login` with the following:

```typescript
import { signIn } from "@/auth";
import { NextRequest } from "next/server";

export async function GET(req: NextRequest) {
  const callback = req.nextUrl.searchParams.get("callbackUrl");
  return signIn("keycloak", callback ? { redirectTo: callback } : undefined);
}
```

This implements the logic, explained above.

### 7. Display data from the backend (challenges)

Alright, now that we have protected our `/protected-route` , let’s display some sensitive data in it from our backend. We’ll modify our `/protected-page/page.tsx`:

```typescript
import { auth } from "@/auth";
import React from "react";

const fetchBackendData = async () => {
  const response = await fetch("http://localhost:8080/protected");
  if (response.status === 401) {
    return "Unauthorized: Please login again";
  }
  if (!response.ok) {
    throw new Error(`Error! Status: ${response.status}`);
  }
  const backendData = await response.json();
  return backendData;
};

async function ProtectedPage() {
  const session = await auth();
  const username = session?.user?.name;

  const backendData = await fetchBackendData();

  return (
    <div className="text-center">
      <h1 className="text-3xl font-bold mb-4">Protected Page</h1>
      <p className="text-gray-800">
        Welcome <span className="text-green-800">{username}!</span>
        <br />
        <br />
        This is a protected page.
        <br />
        <br />
      </p>
      <div>
        <div>This is the data from the backend:</div>
        <div className="text-blue-500">{backendData}</div>
      </div>
    </div>
  );
}

export default ProtectedPage;
```

This stays a server component and we can now easily take our session data from the `auth` object.
We’ll display the username here too, like on the Home page, but we’ll also make a request to our backend and display the data from there.

🤔 🤔 🤔 _Hm, the code above looks suspicious …_

I hope you already noticed why this component will now always return “_Unauthorized_: _Please login again_” for the backend data. We are making an unauthorized request to our backend!

Now we come to the most challenging part — we have a couple of options here.

### Options for secure communication with the backend

1. **Direct API Calls with Bearer Tokens**: Store tokens in the session (Tokens are exposed in client-side code)

2. **Secure Cookie-Based Authentication: Use HTTP-only, secure cookies**: The browser sends the cookie automatically with every request, but additional configuration is needed on the backend.

3. **Backend-for-Frontend (BFF) Pattern**: Using Next.js API Routes as a Secure Proxy and accessing the token only server-side. Create API routes in Next.js that proxy requests to our Quarkus backend. The access token is added to the request on the server side and this way sensitive token operations do not happen in the browser. (Can increase complexity and latency though)

At the time of writing, [Auth.js recommends only the first way in its documentation](https://authjs.dev/guides/integrating-third-party-backends). As briefly mentioned in the explanation above — this way is not perfect and we should understand that it hides some security risks (access token available client-side). I’ll discuss only this strategy in this article because our goal is to play around here, but keep in mind that this way is definitely not mature enough for real-world applications.

**Anyways, let’s get into it**:

#### Direct API Calls with Bearer Tokens

Once a user is authenticated via Auth.js with Keycloak, we can obtain the JWT token,
include it in our session, and add this token in the headers of our requests (e.g., `Authorization: Bearer <access_token>`
[Here](https://www.oauth.com/oauth2-servers/making-authenticated-requests/) is a link if you’d like a quick refresher on the basics).

In order to implement this approach, we actually have to save the token in
our session object. Here is how this can happen in Auth.js — we’ll use the `jwt` and `session` [callbacks](https://authjs.dev/reference/nextjs#callbacks). The `jwt` one, does the following:

> This callback is called whenever a JSON Web Token is created (i.e. at sign in) or updated (i.e whenever a session is accessed in the client). Anything you return here will be saved in the JWT and **forwarded to the session callback**. There you can control what should be returned to the client. Anything else will be kept from your frontend. The JWT is encrypted by default via your AUTH_SECRET environment variable.

Let’s modify our `auth.ts` accordingly:

```typescript
import NextAuth, { NextAuthResult } from "next-auth";
import KeycloakProvider from "next-auth/providers/keycloak";

const authData: NextAuthResult = NextAuth({
  providers: [
    KeycloakProvider({
      clientId: process.env.KEYCLOAK_CLIENT_ID,
      issuer: process.env.KEYCLOAK_ISSUER,
    }),
  ],
  callbacks: {
    jwt({ token, account }) {
      if (account) token.accessToken = account!.access_token;
      return token;
    },
    session({ session, token }) {
      if (token.accessToken) session.accessToken = token.accessToken;
      return session;
    },
  },
});

export const { handlers, signIn, signOut, auth } = authData;
```

**Briefly explained**: We get the token from the [account](https://authjs.dev/reference/nextjs#account) which contains information about the provider being used (Keycloak in our case) and also the different tokens returned by Keycloak.
Then we add it to the token object, which gets passed to the session callback, and there we attach it to the session and make it available in our application.

Now let’s get back to our `/protected-page/page.tsx` and modify the backend call to include the Authorization Header:

```typescript
import { auth } from "@/auth";
import React from "react";

const fetchBackendData = async (accessToken: string) => {
  const response = await fetch("http://localhost:8080/protected", {
    headers: {
      Authorization: `Bearer ${accessToken}`,
      "Content-Type": "application/json",
    },
  });
  if (response.status === 401) {
    return "Unauthorized: Please login again";
  }
  if (!response.ok) {
    throw new Error(`Error! Status: ${response.status}`);
  }
  const backendData = await response.text();
  return backendData;
};

async function ProtectedPage() {
  const session = await auth();
  const username = session?.user?.name;

  const backendData = await fetchBackendData(session.accessToken);

  return (
    <div className="text-center">
      <h1 className="text-3xl font-bold mb-4">Protected Page</h1>
      <p className="text-gray-800">
        Welcome <span className="text-green-800">{username}!</span>
        <br />
        <br />
        This is a protected page.
        <br />
        <br />
      </p>
      <div>
        <div>This is the data from the backend:</div>
        <div className="text-blue-500">{backendData}</div>
      </div>
    </div>
  );
}

export default ProtectedPage;
```

Keep in mind that the security risks we talked about before are mitigated as this here is a server component,
**but** if we use the `useSession()` hook in a client-side component, a malicious script could potentially extract the
token from the session object, as it is accessible in the client-side JavaScript context in the Browser.

Almost everything looks well now:

<Image
  alt="Login video"
  src={"/images/keycloak-quarkus-next/video.gif"}
  placeholder="blur"
  blurDataURL="data:image/webp;base64,UklGRmoJAABXRUJQVlA4WAoAAAAgAAAANgMACQIASUNDUMgBAAAAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADZWUDggfAcAAHCKAJ0BKjcDCgI+7W6wVimlJCOgURjZMB2JaW7hY/7MbvOk+VrDdk0f6n/GRsE//62ZjWPcz5AAw3lnT4AfSeZBVLpzFo3mAH0nmQWf0yqd0+Fsc+ulNOsL0ZwhPesqbHhWNOwfIOIstS3Tmws3cJOYsIL3kLG9kF0m97Av6ysSWZsRErT2humWjNHxuf55Vygb2CMXShiGN7LukysgZZjhEeMDh8qjPi4Ik0cswpp0S02oI7i0mRh9nSZl8c2SRRxv5p5PoOnFoG6dbU5O2zUhb06xunhWNyMXSPgYxqdNADe2oeZvHWTwd9eveXT/1H7ILpN71OTenMU3S6lPPeRKJ5sjsrFrsmMTneECiQEG2SZWob3C2QXSb3m1xRZPPeBjtaaZFxB6nJvTtXdjj3paIGiMjFGb8Ze8hY3sgrFxpBr57wLz3kjI+zRkcPepyb1IEAtF1+FEFyr7HgXoqEp3qS95A8afcVLTTIuJ12e4zFNNMi1/THNNIWN7LsOPykkTwY3xtTk+m54RaakPmmRvz5piuvdn/HrOusFh57UJmu1+pybpXoQXIsS7jGmRcaQp43sfbERRZTrjRx17sy1G2ZwPsJI1QZpAWjOWx9fhQ+B09kqIhEMyW1Y4osnnvAvPeYk0gKHXuygWT3GfyCDYyLijHV3Gj6+dpyG+tNKDdNKaafcINfPeBee8C73Xuy4dFoB2MqaUoYkaoM0f1VLvFYJ/YSmiwYXW1ALRhrSxBFk73XuvehfL3RbmLeoV3rjWM4rTQPHzsuJ0Le9nJGI1C8nnvAvPeBehM9m6JC23ijWLTmNGcogu0rO89nJPGcgv8Cw4ERGlzhbAvQmew7ar7s5yzpeLTmLTpy9q0j2Bwh2U6r64x6Axm9kyLjpebCQ+mx8AfSeZBVL61UfneOknfB/ssurpN8LN2Ryh18seM/Hh4B9J5kFUunMW5zAhhqonghD7mALg+2ls9vrFHYuGEz8APpPMgql03SrrnJrcJdo67+W/FolPT1BQql05i05i05pRKUyzH0lIh822qPph8zpR4mfcg05i05i05i05nnYft/xWCmqwGUZ6pG5WD+d0nmNwwmfgB9J5kFUm+d/4x/+LCDwmy3qQJO3CClOwfIEtOYtOYtOYtN3YttJVXrcCsdl/3+HpS1pN0VEKpOOk8yCqXTmLTmdbWJUepv/3tp7luSZVl3SbUAe3JsH0nmQVS6cxac0ljMvoqSmEJGtMcaZs+ML6dYdIeqXTmLTmLTdl2Qo9rj3SbqtZly8FhRTWosdxnomTPwA+k8yCplvIb6ENSIHyTYZY/+oSxKAFh/EVMWnMWnMWnWF46k3znqz59F0nmyb51UC4CAA7sFpzYPpPMgoO4KaI5qqrpOXrM6bUxadCxfO58QAwPpPMgqsO1TkC62XVfkVQ7K4xHLtDo7G9OpIxacxacxdoJonS0nmXyPGMvdyU++Punxt+IKtlNOYtOZbSINLowAD+6cL3ysOF75JZaYiHVDsf+ZYK0r0gMwG26WmPniuCO0tauSnoYkIjlz9BG0MVtd93BOOi0IgwLWOedZVexOEUUGuemJX9+FbAayeTBIzU0FEMvLUjokbz5YCPuhOEqo1sI/cGGPC6ndAWl45FjvFJtOSOY4AGZVdZuQY2wiXAd61+JKVrUid6je0pTInJHWmEmISd7AcidwlflgUmaI8XK+iiRortPBAAg1mRM5OL4CtNdRRwYRkEJDIaLObQ70yzVL/Htb6IN1IDbk6gdd6bQHE/3Dc3j2S4VNgy6c1C3bX0zViKGApuonmYFvg3kIoOffexTz+3iAaUEiGzgEzM9L8xzTgu3DezxdvgEod771/JIerMKzZzOg/WAh5q7m1tvVDd1JzaqB8ynoNHAqWqv1kQKJ8aAXQDhMEGodc2YTEZMoRljkz2fuTYWOLdA5ij+1SL3oP0o+YSt0G0gGr16G2WIHfSDtroEW9HENVvRZeUhM+gM1vz/uFO9kha+eCFsFyZYWAZi4j6Wv2VufYStlWJTIhqxilVmIGqerRNQRRhvapYjAwNBgFEjcbSNBAAI0dwLy8BuHieL0jqc138GSzOQoodnrE9u1/deAAaUPAGnpzgqbBgU2/vLFNoCVSv8c97YIAeAhj5M49UxJNCTae/F6JNXbbKwAAMmA96kg0OtuuqjT9P6bhCgAAHScvcNnkwLqWJ8zHVDPoshAAHe6m1XGAb5BTtN3A7m8YtoQAChv4jrJFOMepFwAAR5y+ac/AS3yJ/2Ia2UNvNp6oAADDK9+lefKsSf9nFBAgAGGOjJzVJdSOcixVQrkJsMgAAI9YXKSokL21G5I9dXnMqVZfAAbydpoTNHkkJkiZ8jB0LTBPkAEdHmTTLON2e4Nfqa4jiT7LVkQSEwSfLFP01mIAR00nJZYpKgC9j6QO352o14NwzESHqbsn7eYCR/UZ5vrunIXv1hNVF0/UAchcqY6eAz8wv1mQRgY2/zxvbsaWDwtlsemKK44FPAM2ScqoBZ87BADjnrFj+ehQhwWSjdguqABVeCctHlHHWWOIA"
  width={1400}
  height={500}
  objectFit="cover"
  style={{ scale: "100%" }}
/>

that looks very good, **but**:

You will notice one small thing — the logout doesn’t quite work:

If you click on **Logout** -> The Auth.js session is destroyed but Keycloak maintains his session, which keeps the user weirdly logged in.

To fix this, we need to call the Keycloak-Logout URL additionally, after signOut from Auth.js. To correctly call the Keycloak-Logout URL, which is:
`http://<KEYCLOAK_URL>/realms/<KEYCLOAK_REALM>/protocol/openid-connect/logout`
one must also add the `id_token` as the `id_token_hint` parameter. This means, we need to extract the `id_token` from the `account` in our `jwt` callback as well.
Here is how this comes together at the end in our auth.ts:

```typescript
import NextAuth, { NextAuthResult } from "next-auth";
import KeycloakProvider from "next-auth/providers/keycloak";

const authData: NextAuthResult = NextAuth({
  providers: [
    KeycloakProvider({
      clientId: process.env.KEYCLOAK_CLIENT_ID,
      issuer: process.env.KEYCLOAK_ISSUER,
    }),
  ],
  callbacks: {
    jwt({ token, account }) {
      if (account) {
        token.accessToken = account!.access_token;
        token.id_token = account!.id_token;
      }
      return token;
    },
    session({ session, token }) {
      if (token.accessToken) session.accessToken = token.accessToken;
      return session;
    },
  },
  events: {
    async signOut({ token }) {
      const logOutUrl = new URL(`${process.env.KEYCLOAK_ISSUER}/protocol/openid-connect/logout`);
      logOutUrl.searchParams.set("id_token_hint", token.id_token!);
      const response = await fetch(logOutUrl);
      if (!response.ok) {
        console.error("Logout failed");
      }
    },
  },
});

export const { handlers, signIn, signOut, auth } = authData;
```

We call the Keycloak-Logout URL on `signOut` and add the `id_token` to the token object, in order for it to be available in our `signOut` event.

Now we have everything!

## Final Thoughts

Implementing full-stack authentication with **Keycloak**, **Quarkus**, and **Next.js** (via **Auth.js**) is not really a breeze — it involves multiple frameworks, covers backend and frontend paradigms, and battles with Auth.js specifics. In this article, we’ve walked through a working example with real code to demonstrate how these pieces can come together and I hope the additional diagrams and explanations prove useful to developers who want to gain a deeper understanding of the topic.

That said, it's important to mention that **Auth.js**, while perfect for some use cases, still feels relatively **immature** for complex enterprise scenarios like this.
**Injecting the access token into the session object** to make it available to client-side hooks like `useSession` might look convenient but it
**does pose some risks** by exposing sensitive tokens to the browser. So while it's technically possible, it's not always advisable—especially in applications, where high security is a priority.

**I'd love to hear about other developers' experiences with this stack as well!**

Authentication and authorization are complex topics, although many people seem to underestimate
them and approach them with little understanding because there are many great frameworks nowadays that abstract the great complexity
that's hidden behind the scenes here. However, with the right approach — and a deep understanding of the limitations and trade-offs — this can become a great
strength and a valuable skill in a developer's toolset

**Thanks for reading!**

<div className="h-10 w-2"></div>
